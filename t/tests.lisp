;;;; (asdf:test-system 'bops)

(in-package :bops-tests)

(fiveam:def-suite all-tests
    :description "bops test suite.")

(fiveam:in-suite all-tests)

(fiveam:test test-bit-and-vec
  (fiveam:is (equal
              (let ((a1 #*11110000111100001111000011110000111100001111000011110000111100001111000011110000111100001111000011110000111100001111000011110000)
                    (a2 #*11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111)
                    (res (make-array 128 :element-type 'bit)))
                (time (bops:bit-and-vec a1 a2 res 16))
                res)
              #*11110000111100001111000011110000111100001111000011110000111100001111000011110000111100001111000011110000111100001111000011110000)))

(fiveam:test test-bit-and
  (fiveam:is (equal
              (let ((a1 #*11110000111100001111000011110000111100001111000011110000111100001111000011110000111100001111000011110000111100001111000011110000)
                    (a2 #*11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111)
                    (res (make-array 128 :element-type 'bit)))
                (time (bit-and a1 a2 res))
                res)
              #*11110000111100001111000011110000111100001111000011110000111100001111000011110000111100001111000011110000111100001111000011110000)))

(defun run-tests ()
  (fiveam:run! 'all-tests))
